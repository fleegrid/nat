package nat

import (
	"net"
	"testing"
)

func TestIPMap(t *testing.T) {
	m := NewIPMap()

	m.Set(net.IP{0x0d, 0x00, 0x00, 0x01}, net.IP{0x0d, 0x00, 0x00, 0x02})

	i := m.Get(net.IP{0x0d, 0x00, 0x00, 0x01})

	if !i.Equal(net.IP{0x0d, 0x00, 0x00, 0x02}) {
		t.Error("failed")
	}

	m.Delete(net.IP{0x0d, 0x00, 0x00, 0x01})

	i = m.Get(net.IP{0x0d, 0x00, 0x00, 0x01})
	if i != nil {
		t.Error("failed")
	}
}
